#!/bin/bash

extract_cve_info() {
    local cve_link=$1
    local html_data=$(curl -s "$cve_link")

    local cve_id=$(echo "$html_data" | grep -o 'CVE-[0-9]\{4\}-[0-9]\{5\}' | head -1)
    local cve_summary=$(echo "$html_data" | grep -o '<td class="info">[^<]*' | sed 's/<td class="info">//')
    local references=$(echo "$html_data" | grep -o 'https\?://[^"]*' | grep -E '^https?://' | sed 's|</a> ||')
    local cwe=$(echo "$html_data" | grep -o -p '(?<=<td class="info"><a href="/cwe/\d+">).*(?=<)' | head -1)

    echo "CVE ID: $cve_id"
    echo "Summary: $cve_summary"
    echo "References: $references"
    echo "CWE: $cwe"
    echo "==============================="
}

main() {
    if [ -z "$1" ]; then
        echo "Usage: $0 <cve-link>"
        exit 1
    fi

    extract_cve_info "$1"
}

main "$@"